<?xml version="1.0" encoding="utf-8"?>

<odoo>

<record id="pos_sale_report_search" model="ir.ui.view">
    <field name="name">pos.sale.report.search</field>
    <field name="model">pos.sale.report</field>
    <field name="arch"  type="xml">
        <search string="POS orders and Sale orders aggregated report">
            <field name="product_tmpl_id"/>
            <field name="product_id"/>
            <field name="user_id"/>
            <filter name="today" string="Today"
                domain="[('date', '=', context_today().strftime('%Y-%m-%d'))]"/>
             <filter name="yesterday" string="Yesterday"
                domain="[('date', '=', (context_today() + datetime.timedelta(days=-1)).strftime('%Y-%m-%d'))]"/>
            <separator/>
            <filter string="Current Month" name="current_month" domain="[('date','&lt;',(context_today()+relativedelta(months=1)).strftime('%Y-%m-01')), ('date','&gt;=',time.strftime('%Y-%m-01'))]"/>
            <filter string="Last Month"
                         domain="[('date','&lt;=', (context_today()-relativedelta(day=31, months=1)).strftime('%Y-%m-%d')),
                         ('date','&gt;=',(context_today()-relativedelta(day=1,months=1)).strftime('%Y-%m-%d'))]"
                         help="last month"/>
            <separator/>
            <filter string="Year" name="year" domain="[('date','&lt;=', time.strftime('%%Y-12-31')),('date','&gt;=',time.strftime('%%Y-01-01'))]" help="Orders of current year"/>
            <separator/>
            <filter string="Invoiced + PoS" name="invoice_pos" domain="['|',('origin','=','Invoice'),('origin','=','Point of Sale')]"/>
            <filter string="Sale Order + PoS" name="sale_order_pos" domain="['|',('origin','=','Sale Order'),('origin','=','Point of Sale')]"/>
            <group string="Group By" name="groupby">
                <filter name="date_groupby" string="Date" context="{'group_by': 'date'}"/>
                <filter name="product_tmpl_groupby" string="Product" context="{'group_by': 'product_tmpl_id'}"/>
                <filter name="product_groupby" string="Product Variants" context="{'group_by': 'product_id'}"/>
                <filter name="company_groupby" string="Company" invisible="1" context="{'group_by': 'company_id'}"/>
                <filter name="origin_groupby" string="Origin" context="{'group_by': 'origin'}"/>
                <filter name="user_id_groupby" string="Salesperson" context="{'group_by':'user_id'}"/>
            </group>
        </search>
    </field>
</record>

<record id="pos_sale_report_pivot" model="ir.ui.view">
    <field name="name">pos.sale.report.pivot</field>
    <field name="model">pos.sale.report</field>
    <field name="arch"  type="xml">
        <pivot string="POS orders and Sale Orders aggregated report" type="pivot">
            <field name="origin" type="col"/>
            <field name="date" type="row" interval="month"/>
            <field name="price_subtotal" type="measure"/>
        </pivot>
    </field>
</record>

<record id="pos_sale_report_action" model="ir.actions.act_window">
    <field name="name">POS + Sale Orders Analysis</field>
    <field name="res_model">pos.sale.report</field>
    <field name="view_mode">pivot</field>
</record>

<menuitem id="pos_sale_report_menu" action="pos_sale_report_action"
    parent="sales_team.menu_sale_report" sequence="100"/>

<!-- point_of_sale.menu_point_rep -->
</odoo>
